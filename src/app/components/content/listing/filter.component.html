
<div class="grid-filter" id="GridFilter">
  <form [formGroup]="filter">
  <div class="grid-filter-header">
    <h5>
      Filter
    </h5>
    <span class="clear" *ngIf="filterActive()" (click)="clear($event, 'all')">
      Clear All
    </span>
  </div>
  <a href="#" (click)="showFilter($event)" class="btn filter-show-hide">Show</a>
  <fieldset class="filter-fieldset">
    <legend>
      <a href="#" class="collapse-toggle" (click)="toggleFilter($event)">
        Search Term
        <span class="clear" *ngIf="filter.value.term" (click)="clear($event, 'term')">
          Clear
        </span>
      </a>
    </legend>
    <!-- <input id="filterSearch" [formControl]="term" class="form-control filter-search-term" type="text" [(ngModel)]="filterSearch" (keyup)="search(filterSearch)" placeholder="e.g. Social studies" /> -->
    <input id="filterSearch" formControlName="term" class="form-control filter-search-term" type="text" placeholder="e.g. Social studies" (keyup)="search()"/>
  </fieldset>
  <fieldset class="filter-fieldset flex-none">
    <legend>
      <a href="#" class="collapse-toggle" (click)="toggleFilter($event)">
        Content Type(s)
        <span class="clear" *ngIf="checkboxesActive(types)" (click)="clear($event, 'types')">
          Clear
        </span>
      </a>
    </legend>
    <button class="btn btn-sm" *ngFor="let type of types" (click)="setFilter($event, type)" [ngClass]="{active: type.active, 'type.class': type.active}" ngDefaultControl>{{type.label}}</button>

    <div class="form-group hidden-xs-up" *ngFor="let type of types">
      <label class="custom-control custom-checkbox">
        <input formControlName="{{type.name}}" type="checkbox">
        <span class="custom-control-description">{{type.label}}</span>
      </label>
    </div>

  </fieldset>
  <fieldset>
    <legend>
      <a href="#" class="collapse-toggle" (click)="toggleFilter($event)">
        Subject <span class="clear" *ngIf="subjectsActive(filterSubjects)" (click)="clear($event, 'subjects')">Clear</span></a>
    </legend>
    <select (change)="setSubject($event, value)" formControlName="subject" class="custom-select form-control">
      <option selected="selected">
        All
      </option>
      <option *ngFor="let subject of subjects" [value]="subject.label">{{subject.label}}</option>
    </select>
  </fieldset>
  <fieldset class="filter-fieldset filter-keystage flex-none">
    <legend>
      <a href="#" class="collapse-toggle" (click)="toggleFilter($event)">
        Key Stage(s)
        <span class="clear"  *ngIf="checkboxesActive(keystages)" (click)="clear($event, 'keystages')">
          Clear
        </span>
      </a>
    </legend>
    <button class="btn btn-sm" *ngFor="let key of keystages" (click)="setFilter($event, key)" [ngClass]="{active: key.active}" ngDefaultControl>{{key.label}}</button>

    <div class="form-group hidden-xs-up" *ngFor="let key of keystages">
      <label class="custom-control custom-checkbox">
        <input formControlName="{{key.name}}" type="checkbox">
        <span class="custom-control-description">{{key.label}}</span>
      </label>
    </div>


  </fieldset>
  <fieldset class="filter-fieldset">
    <legend>
      <a href="#" class="collapse-toggle" (click)="toggleFilter($event)">
        Categories
        <span class="clear" *ngIf="filterCategory" (click)="clear($event, 'categories')">
          Clear
        </span>
      </a>
    </legend>
    <div class="form-group" *ngFor="let category of categories">
      <div class="form-check">
        <label class="form-check-label">
          <div class="custom-control custom-radio">
            <input type="radio" class="custom-control-input" name="filterCategories" [value]="category.label" id="{{category.label}}" (change)="displaySubCategories($event)">
            <div class="custom-control-indicator"></div>
          </div>
          {{category.label}} ({{category.count}})
        </label>
      </div>
    </div>
  </fieldset>
  <fieldset class="filter-fieldset" *ngIf="subCategories.length">
    <legend>
      <a href="#" class="collapse-toggle" (click)="toggleFilter($event)">
        Topics
        <span class="clear" *ngIf="filterSubCategories.length" (click)="clear($event, 'subCategories')">
          Clear
        </span>
      </a>
    </legend>
    <div class="form-group" *ngFor="let subcategory of subCategories">
      <label class="custom-control custom-checkbox">
        <input type="checkbox" class="custom-control-input" value="{{subcategory.label}}" (change)="setSubCategories($event)">
        <div class="custom-control-indicator"></div>
        <span class="custom-control-description">{{subcategory.label}} ({{subcategory.count}})</span>
      </label>
    </div>
  </fieldset>
</form>
</div>
